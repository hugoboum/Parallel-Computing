<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="lib/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="lib/jquery-1.12.4/jquery.min.js"></script>
<script src="lib/d3-3.5.6/d3.min.js"></script>
<link href="lib/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="lib/profvis-0.3.6/profvis.js"></script>
<link href="lib/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="lib/highlight-6.2.0/highlight.js"></script>
<script src="lib/profvis-binding-0.3.6/profvis.js"></script>

</head>
<body>
<div id="htmlwidget-16debe9450ff26462c2e" style="width:960px;height:500px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-16debe9450ff26462c2e">{"x":{"message":{"prof":{"time":[1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,10,10,10,10,11,11,11,11,11,12,12,12,12,13,13,13,13,13,13,14,14,14,15,15,15,15,15,15,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,20,20,20,20,20,20,21,21,21,22,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,24,25,25,25,25,26,26,26,26,26,26,27,27,27,28,28,28,28,29,29,29,29,30,30,30,30,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,34,34,34,34,34,34,35,35,35],"depth":[4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,5,4,3,2,1,4,3,2,1,5,4,3,2,1,4,3,2,1,6,5,4,3,2,1,3,2,1,6,5,4,3,2,1,4,3,2,1,5,4,3,2,1,6,5,4,3,2,1,4,3,2,1,6,5,4,3,2,1,3,2,1,6,5,4,3,2,1,5,4,3,2,1,6,5,4,3,2,1,4,3,2,1,6,5,4,3,2,1,3,2,1,4,3,2,1,4,3,2,1,4,3,2,1,6,5,4,3,2,1,6,5,4,3,2,1,4,3,2,1,6,5,4,3,2,1,3,2,1],"label":["lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})","FUN","lapply","sapply","loglikl","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","FUN","lapply","sapply","hessian","rhapson_newton","sapply","loglikl","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})","FUN","lapply","sapply","loglikl","rhapson_newton","unique","simplify2array","sapply","loglikl","rhapson_newton","lapply","sapply","hessian","rhapson_newton","as.matrix","solve.default","solve","matmut","rhapson_newton","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","matrix","hessian","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","FUN","lapply","sapply","hessian","rhapson_newton","simplify2array","sapply","hessian","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","lapply","sapply","hessian","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","<Anonymous>","matmut","hessian","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","u = exp(matmut(x_sub,beta)) / (1 + exp(matmut(x_sub,beta)))","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})","FUN","lapply","sapply","loglikl","rhapson_newton","array","as.matrix.default","as.matrix","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","FUN","lapply","sapply","hessian","rhapson_newton","lapply","sapply","loglikl","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})","FUN","lapply","sapply","loglikl","rhapson_newton","matmut","gradient","rhapson_newton","lapply","sapply","gradient","rhapson_newton","lapply","sapply","gradient","rhapson_newton","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","unique.default","unique","simplify2array","sapply","loglikl","rhapson_newton","lapply","sapply","gradient","rhapson_newton","vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","sapply","gradient","rhapson_newton","h = matrix(rowSums(vec),ncol(x_sub),ncol(x_sub))","hessian","rhapson_newton"],"filenum":[null,1,1,2,1,null,null,1,1,2,1,null,null,1,1,2,1,null,null,1,1,2,1,null,null,1,1,2,1,1,2,1,null,null,1,1,2,1,null,null,1,1,2,null,null,1,1,2,null,1,1,2,null,null,1,1,2,null,1,1,2,1,null,null,1,1,2,1,1,2,1,null,null,1,1,2,null,1,1,2,1,null,1,1,2,1,null,null,1,1,2,null,1,1,2,1,null,null,1,1,2,1,1,2,1,null,null,1,1,2,null,null,1,1,2,1,null,null,1,1,2,null,1,1,2,1,null,null,1,1,2,1,1,2,null,1,1,2,null,1,1,2,null,1,1,2,1,null,null,1,1,2,null,null,null,1,1,2,null,1,1,2,1,null,null,1,1,2,1,1,2],"linenum":[null,30,51,2,30,null,null,30,51,2,30,null,null,30,51,2,23,null,null,23,50,2,37,null,null,37,52,2,23,50,2,30,null,null,30,51,2,23,null,null,23,50,2,null,null,23,50,2,null,37,52,2,null,null,53,53,2,null,30,51,2,30,null,null,30,51,2,38,52,2,37,null,null,37,52,2,null,37,52,2,37,null,37,52,2,30,null,null,30,51,2,null,35,52,2,30,null,null,30,51,2,29,51,2,23,null,null,23,50,2,null,null,31,51,2,37,null,null,37,52,2,null,23,50,2,23,null,null,23,50,2,29,51,2,null,30,51,2,null,30,51,2,null,30,51,2,30,null,null,30,51,2,null,null,null,23,50,2,null,30,51,2,30,null,null,30,51,2,38,52,2],"memalloc":[47.326904296875,47.326904296875,47.326904296875,47.326904296875,47.5793762207031,47.5793762207031,47.5793762207031,47.5793762207031,47.5793762207031,47.5793762207031,48.2948989868164,48.2948989868164,48.2948989868164,48.2948989868164,48.2948989868164,48.2948989868164,48.9723358154297,48.9723358154297,48.9723358154297,48.9723358154297,48.9723358154297,48.9723358154297,50.2523803710938,50.2523803710938,50.2523803710938,50.2523803710938,50.2523803710938,50.2523803710938,51.1650543212891,51.1650543212891,51.1650543212891,52.5402069091797,52.5402069091797,52.5402069091797,52.5402069091797,52.5402069091797,52.5402069091797,53.4646224975586,53.4646224975586,53.4646224975586,53.4646224975586,53.4646224975586,53.4646224975586,54.8315505981445,54.8315505981445,54.8315505981445,54.8315505981445,54.8315505981445,55.7484893798828,55.7484893798828,55.7484893798828,55.7484893798828,57.1270523071289,57.1270523071289,57.1270523071289,57.1270523071289,57.1270523071289,58.0357284545898,58.0357284545898,58.0357284545898,58.0357284545898,59.4045333862305,59.4045333862305,59.4045333862305,59.4045333862305,59.4045333862305,59.4045333862305,60.3258590698242,60.3258590698242,60.3258590698242,61.7169418334961,61.7169418334961,61.7169418334961,61.7169418334961,61.7169418334961,61.7169418334961,62.6587677001953,62.6587677001953,62.6587677001953,62.6587677001953,64.0501937866211,64.0501937866211,64.0501937866211,64.0501937866211,64.0501937866211,64.975959777832,64.975959777832,64.975959777832,64.975959777832,64.975959777832,64.975959777832,46.6124649047852,46.6124649047852,46.6124649047852,46.6124649047852,47.4680328369141,47.4680328369141,47.4680328369141,47.4680328369141,47.4680328369141,47.4680328369141,48.7576446533203,48.7576446533203,48.7576446533203,49.6164016723633,49.6164016723633,49.6164016723633,49.6164016723633,49.6164016723633,49.6164016723633,50.9614181518555,50.9614181518555,50.9614181518555,50.9614181518555,50.9614181518555,51.9012985229492,51.9012985229492,51.9012985229492,51.9012985229492,51.9012985229492,51.9012985229492,53.3174133300781,53.3174133300781,53.3174133300781,53.3174133300781,54.2530517578125,54.2530517578125,54.2530517578125,54.2530517578125,54.2530517578125,54.2530517578125,55.6585235595703,55.6585235595703,55.6585235595703,56.597785949707,56.597785949707,56.597785949707,56.597785949707,57.9987487792969,57.9987487792969,57.9987487792969,57.9987487792969,58.9337463378906,58.9337463378906,58.9337463378906,58.9337463378906,60.3330993652344,60.3330993652344,60.3330993652344,60.3330993652344,60.3330993652344,60.3330993652344,61.2625350952148,61.2625350952148,61.2625350952148,61.2625350952148,61.2625350952148,61.2625350952148,62.6703109741211,62.6703109741211,62.6703109741211,62.6703109741211,63.6058502197266,63.6058502197266,63.6058502197266,63.6058502197266,63.6058502197266,63.6058502197266,64.9954147338867,64.9954147338867,64.9954147338867],"meminc":[0,0,0,0,0.252471923828125,0,0,0,0,0,0.715522766113281,0,0,0,0,0,0.677436828613281,0,0,0,0,0,1.28004455566406,0,0,0,0,0,0.912673950195312,0,0,1.37515258789062,0,0,0,0,0,0.924415588378906,0,0,0,0,0,1.36692810058594,0,0,0,0,0.916938781738281,0,0,0,1.37856292724609,0,0,0,0,0.908676147460938,0,0,0,1.36880493164062,0,0,0,0,0,0.92132568359375,0,0,1.39108276367188,0,0,0,0,0,0.941825866699219,0,0,0,1.39142608642578,0,0,0,0,0.925765991210938,0,0,0,0,0,-18.3634948730469,0,0,0,0.855567932128906,0,0,0,0,0,1.28961181640625,0,0,0.858757019042969,0,0,0,0,0,1.34501647949219,0,0,0,0,0.93988037109375,0,0,0,0,0,1.41611480712891,0,0,0,0.935638427734375,0,0,0,0,0,1.40547180175781,0,0,0.939262390136719,0,0,0,1.40096282958984,0,0,0,0.93499755859375,0,0,0,1.39935302734375,0,0,0,0,0,0.929435729980469,0,0,0,0,0,1.40777587890625,0,0,0,0.935539245605469,0,0,0,0,0,1.38956451416016,0,0],"filename":[null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>",null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R",null,null,"./aux_fcts_3.R","./aux_fcts_3.R","<expr>","./aux_fcts_3.R","./aux_fcts_3.R","<expr>"]},"interval":10,"files":[{"filename":"<expr>","content":"p= profvis({\n  beta_s =  rhapson_newton(x = data$x[,1:k],y = data$y,betaO = as.matrix(rep(1,k)),eps = 1e-3)\n})\n","normpath":"<expr>"},{"filename":"./aux_fcts_3.R","content":"# Auxiliary functions\n\nlibrary(Rcpp)\nlibrary(inline)\n\nmatmut <- cxxfunction(signature(tm=\"NumericMatrix\",\n                               tm2=\"NumericMatrix\"),\n                     plugin=\"RcppEigen\",\n                     body=\"\nNumericMatrix tm22(tm2);\nNumericMatrix tmm(tm);\n\nconst Eigen::Map<Eigen::MatrixXd> ttm(as<Eigen::Map<Eigen::MatrixXd> >(tmm));\nconst Eigen::Map<Eigen::MatrixXd> ttm2(as<Eigen::Map<Eigen::MatrixXd> >(tm22));\n\nEigen::MatrixXd prod = ttm*ttm2;\nreturn(wrap(prod));\n                 \")\n\n\nloglikl <- function(x_sub,y,beta) {\n  u = exp(matmut(x_sub,beta)) / (1 + exp(matmut(x_sub,beta)))\n  vec = sapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})\n  return(-sum(vec))\n}\n\n\ngradient = function(x_sub,y,beta) {\n  u = exp(matmut(x_sub,beta)) / (1 + exp(matmut(x_sub,beta)))\n  vec = sapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})\n  return(as.matrix(rowSums(vec)))\n}\n\nhessian = function(x_sub,y,beta) {\n  u = exp(matmut(x_sub,beta)) / (1 + exp(matmut(x_sub,beta)))\n  xtx = matmut(t(x_sub),x_sub)\n  vec = sapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})\n  h = matrix(rowSums(vec),ncol(x_sub),ncol(x_sub))\n  return(h)\n}\n\nnorm_vec <- function(x) sqrt(sum(x^2))\n  \n\nrhapson_newton <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian(x_sub = x,y = y,beta = beta)\n    dir = matmut(solve(hes),grd)\n    beta = beta - dir\n  }\n  return(beta)\n}\n","normpath":"/home/hugoboum/Documents/Parallel Computing/Project/aux_fcts_3.R"}],"prof_output":"/home/hugoboum/Documents/Parallel Computing/Project/.Rproj.user/99588069/profiles-cache/file343b4ba87a26.Rprof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
</body>
</html>
