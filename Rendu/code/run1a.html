<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="lib/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="lib/jquery-1.12.4/jquery.min.js"></script>
<script src="lib/d3-3.5.6/d3.min.js"></script>
<link href="lib/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="lib/profvis-0.3.6/profvis.js"></script>
<link href="lib/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="lib/highlight-6.2.0/highlight.js"></script>
<script src="lib/profvis-binding-0.3.6/profvis.js"></script>

</head>
<body>
<div id="htmlwidget-ba72ed2f891bcbf14280" style="width:960px;height:500px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-ba72ed2f891bcbf14280">{"x":{"message":{"prof":{"time":[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,18,18,19,19,19,20,20,20,20,21,21,21,21,22,22,22,22,23,23,23,24,24,24,24,25,25,25,26,26,26,27,27,27,28,28,28,29,29,29,30,30,30,31,31,31,32,32,32,32,33,33,33,33,34,34,34,35,35,35,36,36,36,37,37,37,38,38,38,39,39,39,39,40,40,40,40,41,41,41,42,42,42,42,43,43,43,44,44,44,45,45,45,45,46,46,46],"depth":[3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,4,3,2,1,4,3,2,1,4,3,2,1,3,2,1,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,4,3,2,1,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,4,3,2,1,4,3,2,1,3,2,1,4,3,2,1,3,2,1,3,2,1,4,3,2,1,3,2,1],"label":["h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))","gradient","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","<GC>","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton_old","t","hessian_old","rhapson_newton_old","<GC>","g= rep(0,ncol(x_sub))","gradient","rhapson_newton_old","as.matrix","solve.default","solve","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","t","hessian_old","rhapson_newton_old","<GC>","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","l = l - (y[i]*log(u[i]) + (1-y[i])*log(1-u[i]))","loglikl","rhapson_newton_old","t","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","<GC>","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton_old","%*%","loglikl","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","t","hessian_old","rhapson_newton_old","h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub","hessian_old","rhapson_newton_old","t.default","t","hessian_old","rhapson_newton_old","%*%","hessian_old","rhapson_newton_old"],"filenum":[1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,null,1,1,2,null,null,1,2,null,1,1,2,1,1,2,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1,2,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,null,1,1,2,null,1,1,2,1,1,2,null,1,1,2,1,1,2,1,1,2,null,1,1,2,1,1,2],"linenum":[30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,null,30,57,2,30,57,2,17,56,2,30,57,2,30,57,2,null,30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,20,56,2,30,57,2,null,16,56,2,null,null,58,2,null,30,57,2,30,57,2,null,30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,30,57,2,20,56,2,30,57,2,30,30,57,2,null,30,57,2,30,57,2,30,57,2,9,55,2,30,57,2,30,57,2,null,30,57,2,null,20,56,2,5,55,2,null,30,57,2,30,57,2,30,57,2,null,30,57,2,30,57,2],"memalloc":[14.3874893188477,14.3874893188477,14.3874893188477,17.4930725097656,17.4930725097656,17.4930725097656,22.2265930175781,22.2265930175781,22.2265930175781,25.5614242553711,25.5614242553711,25.5614242553711,29.682502746582,29.682502746582,29.682502746582,32.3921737670898,32.3921737670898,32.3921737670898,14.5946578979492,14.5946578979492,14.5946578979492,17.9311141967773,17.9311141967773,17.9311141967773,17.9311141967773,22.9413299560547,22.9413299560547,22.9413299560547,26.3065490722656,26.3065490722656,26.3065490722656,31.2660293579102,31.2660293579102,31.2660293579102,34.3241577148438,34.3241577148438,34.3241577148438,38.6294708251953,38.6294708251953,38.6294708251953,38.6294708251953,14.0007476806641,14.0007476806641,14.0007476806641,18.9045181274414,18.9045181274414,18.9045181274414,22.1851425170898,22.1851425170898,22.1851425170898,27.0761489868164,27.0761489868164,27.0761489868164,30.4121170043945,30.4121170043945,30.4121170043945,35.4993515014648,35.4993515014648,35.4993515014648,38.6727981567383,38.6727981567383,38.6727981567383,38.6727981567383,15.9142456054688,15.9142456054688,15.9142456054688,15.9142456054688,19.3251647949219,19.3251647949219,19.3251647949219,19.3251647949219,24.5076599121094,24.5076599121094,24.5076599121094,27.9330368041992,27.9330368041992,27.9330368041992,27.9330368041992,33.015007019043,33.015007019043,33.015007019043,36.4200057983398,36.4200057983398,36.4200057983398,13.480339050293,13.480339050293,13.480339050293,16.9331741333008,16.9331741333008,16.9331741333008,22.1407623291016,22.1407623291016,22.1407623291016,25.5844192504883,25.5844192504883,25.5844192504883,30.7118835449219,30.7118835449219,30.7118835449219,34.0498733520508,34.0498733520508,34.0498733520508,34.0498733520508,38.6259384155273,38.6259384155273,38.6259384155273,38.6259384155273,14.5187072753906,14.5187072753906,14.5187072753906,19.7075729370117,19.7075729370117,19.7075729370117,23.1114959716797,23.1114959716797,23.1114959716797,28.2595672607422,28.2595672607422,28.2595672607422,31.6247024536133,31.6247024536133,31.6247024536133,36.6923522949219,36.6923522949219,36.6923522949219,36.6923522949219,17.9585876464844,17.9585876464844,17.9585876464844,17.9585876464844,17.2626876831055,17.2626876831055,17.2626876831055,20.7034912109375,20.7034912109375,20.7034912109375,20.7034912109375,25.8887405395508,25.8887405395508,25.8887405395508,29.3447647094727,29.3447647094727,29.3447647094727,34.4266967773438,34.4266967773438,34.4266967773438,34.4266967773438,37.788688659668,37.788688659668,37.788688659668],"meminc":[0,0,0,3.10558319091797,0,0,4.7335205078125,0,0,3.33483123779297,0,0,4.12107849121094,0,0,2.70967102050781,0,0,-17.7975158691406,0,0,3.33645629882812,0,0,0,5.01021575927734,0,0,3.36521911621094,0,0,4.95948028564453,0,0,3.05812835693359,0,0,4.30531311035156,0,0,0,-24.6287231445312,0,0,4.90377044677734,0,0,3.28062438964844,0,0,4.89100646972656,0,0,3.33596801757812,0,0,5.08723449707031,0,0,3.17344665527344,0,0,0,-22.7585525512695,0,0,0,3.41091918945312,0,0,0,5.1824951171875,0,0,3.42537689208984,0,0,0,5.08197021484375,0,0,3.40499877929688,0,0,-22.9396667480469,0,0,3.45283508300781,0,0,5.20758819580078,0,0,3.44365692138672,0,0,5.12746429443359,0,0,3.33798980712891,0,0,0,4.57606506347656,0,0,0,-24.1072311401367,0,0,5.18886566162109,0,0,3.40392303466797,0,0,5.1480712890625,0,0,3.36513519287109,0,0,5.06764984130859,0,0,0,-18.7337646484375,0,0,0,-0.695899963378906,0,0,3.44080352783203,0,0,0,5.18524932861328,0,0,3.45602416992188,0,0,5.08193206787109,0,0,0,3.36199188232422,0,0],"filename":["./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>",null,null,"./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>"]},"interval":10,"files":[{"filename":"<expr>","content":"p= profvis({\n  beta_s =  rhapson_newton_old(x = data$x[,1:k],y = data$y,betaO = rep(1,k),eps = 1e-3)\n})\n","normpath":"<expr>"},{"filename":"./aux_fcts.R","content":"# Auxiliary functions\n\nloglikl <- function(x_sub,y,beta) {\n  \n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  \n  l=0\n  for (i in 1:nrow(x_sub)) {\n    l = l - (y[i]*log(u[i]) + (1-y[i])*log(1-u[i]))\n  }\n  return(l)\n}\n\n\ngradient = function(x_sub,y,beta) {\n  g= rep(0,ncol(x_sub))\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  \n  for (i in 1:nrow(x_sub)) {\n    g = g + x_sub[i,]*(u[i]-y[i])\n  }\n  return(g)\n}\n\nhessian_old = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  h = matrix(0,ncol(x_sub),ncol(x_sub))\n  \n  for (i in 1:nrow(x_sub)) {\n    h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub\n  }\n  return(h)\n}\n\n\nhessian = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  h = matrix(0,ncol(x_sub),ncol(x_sub))\n  txsub = t(x_sub)\n  \n  for (i in 1:nrow(x_sub)) {\n    h = h + u[i]*(1-u[i]) * txsub %*% x_sub\n  }\n  return(h)\n}\n\nnorm_vec <- function(x) sqrt(sum(x^2))\n\n\nrhapson_newton_old <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian_old(x_sub = x,y = y,beta = beta)\n    dir = solve(hes) %*% grd\n    beta = beta - dir\n  }\n  return(beta)\n}\n\nrhapson_newton <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian(x_sub = x,y = y,beta = beta)\n    dir = solve(hes) %*% grd\n    beta = beta - dir\n  }\n  return(beta)\n}\n","normpath":"/home/hugoboum/Documents/Parallel Computing/Project/aux_fcts.R"}],"prof_output":"/home/hugoboum/Documents/Parallel Computing/Project/.Rproj.user/99588069/profiles-cache/file2bf834c36d60.Rprof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
</body>
</html>
