<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="lib/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="lib/jquery-1.12.4/jquery.min.js"></script>
<script src="lib/d3-3.5.6/d3.min.js"></script>
<link href="lib/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="lib/profvis-0.3.6/profvis.js"></script>
<link href="lib/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="lib/highlight-6.2.0/highlight.js"></script>
<script src="lib/profvis-binding-0.3.6/profvis.js"></script>

</head>
<body>
<div id="htmlwidget-3ec9a85b24ad52e08f05" style="width:960px;height:500px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-3ec9a85b24ad52e08f05">{"x":{"message":{"prof":{"time":[1,1,1,1,1,2,2,2,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,7,7,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,13,13,14,14,14,15,15,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,19,19,19,20,20,20,21,21,21,22,22,22,23,23,23,23,23,23,24,24,24,25,25,25,26,26,26,27,27,27,28,28,28,28,28,29,29,29,30,30,30],"depth":[5,4,3,2,1,6,5,4,3,2,1,3,2,1,5,4,3,2,1,5,4,3,2,1,3,2,1,5,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,5,4,3,2,1,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,6,5,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,5,4,3,2,1,3,2,1,3,2,1],"label":["vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","unlist","matrix","is.data.frame","rowSums","gradient","rhapson_newton","lapply","gradient","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","FUN","lapply","hessian","rhapson_newton","lapply","loglikl","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","solve.default","solve","rhapson_newton","lapply","gradient","rhapson_newton","u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))","loglikl","rhapson_newton","lapply","gradient","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","hessian","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","t","hessian","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})","FUN","lapply","hessian","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","lapply","hessian","rhapson_newton","lapply","hessian","rhapson_newton","solve.default","solve","rhapson_newton","lapply","hessian","rhapson_newton","lapply","loglikl","rhapson_newton","unlist","matrix","is.data.frame","rowSums","gradient","rhapson_newton","lapply","gradient","rhapson_newton","lapply","loglikl","rhapson_newton","lapply","loglikl","rhapson_newton","lapply","hessian","rhapson_newton","vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})","FUN","lapply","gradient","rhapson_newton","lapply","loglikl","rhapson_newton","u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))","loglikl","rhapson_newton"],"filenum":[1,null,1,1,2,1,1,null,1,1,2,1,1,2,1,null,1,1,2,1,null,1,1,2,1,1,2,1,null,1,1,2,null,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,null,1,1,2,1,1,2,1,null,1,1,2,1,null,1,1,2,1,null,1,1,2,1,1,2,1,1,2,null,1,2,1,1,2,1,1,2,1,1,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,null,1,1,2,1,1,2,1,1,2],"linenum":[31,null,31,53,2,32,32,null,32,53,2,31,53,2,31,null,31,53,2,39,null,39,54,2,23,52,2,31,null,31,53,2,null,55,2,31,53,2,22,52,2,31,53,2,39,54,2,31,null,31,53,2,38,54,2,31,null,31,53,2,39,null,39,54,2,31,null,31,53,2,39,54,2,39,54,2,null,55,2,39,54,2,23,52,2,32,32,null,32,53,2,31,53,2,23,52,2,23,52,2,39,54,2,31,null,31,53,2,23,52,2,22,52,2],"memalloc":[47.7357177734375,47.7357177734375,47.7357177734375,47.7357177734375,47.7357177734375,48.5378799438477,48.5378799438477,48.5378799438477,48.5378799438477,48.5378799438477,48.5378799438477,49.6873321533203,49.6873321533203,49.6873321533203,50.5172805786133,50.5172805786133,50.5172805786133,50.5172805786133,50.5172805786133,51.7750930786133,51.7750930786133,51.7750930786133,51.7750930786133,51.7750930786133,52.6154098510742,52.6154098510742,52.6154098510742,53.8655548095703,53.8655548095703,53.8655548095703,53.8655548095703,53.8655548095703,54.7136001586914,54.7136001586914,54.7136001586914,55.9673767089844,55.9673767089844,55.9673767089844,56.8177337646484,56.8177337646484,56.8177337646484,58.0697631835938,58.0697631835938,58.0697631835938,58.9061660766602,58.9061660766602,58.9061660766602,60.1702499389648,60.1702499389648,60.1702499389648,60.1702499389648,60.1702499389648,61.0068817138672,61.0068817138672,61.0068817138672,62.2415237426758,62.2415237426758,62.2415237426758,62.2415237426758,62.2415237426758,46.4248352050781,46.4248352050781,46.4248352050781,46.4248352050781,46.4248352050781,47.6876831054688,47.6876831054688,47.6876831054688,47.6876831054688,47.6876831054688,48.55712890625,48.55712890625,48.55712890625,49.8572616577148,49.8572616577148,49.8572616577148,50.7267074584961,50.7267074584961,50.7267074584961,52.0203170776367,52.0203170776367,52.0203170776367,52.8908538818359,52.8908538818359,52.8908538818359,54.1723709106445,54.1723709106445,54.1723709106445,54.1723709106445,54.1723709106445,54.1723709106445,55.0284881591797,55.0284881591797,55.0284881591797,56.3245468139648,56.3245468139648,56.3245468139648,57.184211730957,57.184211730957,57.184211730957,58.4733963012695,58.4733963012695,58.4733963012695,59.3242645263672,59.3242645263672,59.3242645263672,59.3242645263672,59.3242645263672,60.6188125610352,60.6188125610352,60.6188125610352,61.4758605957031,61.4758605957031,61.4758605957031],"meminc":[0,0,0,0,0,0.802162170410156,0,0,0,0,0,1.14945220947266,0,0,0.829948425292969,0,0,0,0,1.2578125,0,0,0,0,0.840316772460938,0,0,1.25014495849609,0,0,0,0,0.848045349121094,0,0,1.25377655029297,0,0,0.850357055664062,0,0,1.25202941894531,0,0,0.836402893066406,0,0,1.26408386230469,0,0,0,0,0.836631774902344,0,0,1.23464202880859,0,0,0,0,-15.8166885375977,0,0,0,0,1.26284790039062,0,0,0,0,0.86944580078125,0,0,1.30013275146484,0,0,0.86944580078125,0,0,1.29360961914062,0,0,0.870536804199219,0,0,1.28151702880859,0,0,0,0,0,0.856117248535156,0,0,1.29605865478516,0,0,0.859664916992188,0,0,1.2891845703125,0,0,0.850868225097656,0,0,0,0,1.29454803466797,0,0,0.857048034667969,0,0],"filename":["./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>",null,"./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>",null,"./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R",null,"./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>","./aux_fcts_4.R","./aux_fcts_4.R","<expr>"]},"interval":10,"files":[{"filename":"<expr>","content":"p= profvis({\n  beta_s =  rhapson_newton(x = data$x[,1:k],y = data$y,betaO = as.matrix(rep(1,k)),eps = 1e-3)\n})\n","normpath":"<expr>"},{"filename":"./aux_fcts_4.R","content":"# Auxiliary functions\n\nlibrary(Rcpp)\nlibrary(inline)\n\nmatmut <- cxxfunction(signature(tm=\"NumericMatrix\",\n                               tm2=\"NumericMatrix\"),\n                     plugin=\"RcppEigen\",\n                     body=\"\nNumericMatrix tm22(tm2);\nNumericMatrix tmm(tm);\n\nconst Eigen::Map<Eigen::MatrixXd> ttm(as<Eigen::Map<Eigen::MatrixXd> >(tmm));\nconst Eigen::Map<Eigen::MatrixXd> ttm2(as<Eigen::Map<Eigen::MatrixXd> >(tm22));\n\nEigen::MatrixXd prod = ttm*ttm2;\nreturn(wrap(prod));\n                 \")\n\n\nloglikl <- function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  vec = lapply(1:nrow(x_sub),function(i){y[i]*log(u[i]) + (1-y[i])*log(1-u[i])})\n  l = do.call(sum,vec)\n  return(-l)\n}\n\n\ngradient = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  vec = lapply(1:nrow(x_sub),function(i){x_sub[i,]*(u[i]-y[i])})\n  vec = rowSums(matrix(unlist(vec),ncol(x_sub)))\n  return(as.matrix(vec))\n}\n\nhessian = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  xtx = t(x_sub) %*% x_sub\n  vec = lapply(1:nrow(x_sub),function(i){u[i]*(1-u[i]) * xtx})\n  vec = rowSums(matrix(unlist(vec),ncol(x_sub)**2))\n  return(matrix(vec,ncol(x_sub),ncol(x_sub)))\n}\n\nnorm_vec <- function(x) sqrt(sum(x^2))\n  \n\nrhapson_newton <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian(x_sub = x,y = y,beta = beta)\n    dir = solve(hes) %*% grd\n    beta = beta - dir\n  }\n  return(beta)\n}\n","normpath":"/home/hugoboum/Documents/Parallel Computing/Project/aux_fcts_4.R"}],"prof_output":"/home/hugoboum/Documents/Parallel Computing/Project/.Rproj.user/99588069/profiles-cache/file343b3fe9bee7.Rprof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
</body>
</html>
