<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>body{background-color:white;}</style>
<script src="lib/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="lib/jquery-1.12.4/jquery.min.js"></script>
<script src="lib/d3-3.5.6/d3.min.js"></script>
<link href="lib/profvis-0.3.6/profvis.css" rel="stylesheet" />
<script src="lib/profvis-0.3.6/profvis.js"></script>
<link href="lib/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="lib/highlight-6.2.0/highlight.js"></script>
<script src="lib/profvis-binding-0.3.6/profvis.js"></script>

</head>
<body>
<div id="htmlwidget-5f3da25a95be588e7a22" style="width:960px;height:500px;" class="profvis html-widget"></div>
<script type="application/json" data-for="htmlwidget-5f3da25a95be588e7a22">{"x":{"message":{"prof":{"time":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,14,14,14,15,15,16,16,16,17,17,17,17,18,18,18,19,19,19,20,20,20,21,21,21,22,22,22,23,23,23,24,24,24,25,25,25],"depth":[28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,2,1,3,2,1,4,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1,3,2,1],"label":["cmpPrim1","h","tryInline","cmpCall","cmp","cmpPrim2","h","tryInline","cmpCall","cmp","cmpSymbolAssign","h","tryInline","cmpCall","cmp","h","tryInline","cmpCall","cmp","genCode","cmpfun","doTryCatch","tryCatchOne","tryCatchList","tryCatch","compiler:::tryCmpfun","gradient","rhapson_newton","h","tryInline","cmpCall","cmp","cmpForBody","h","tryInline","cmpCall","cmp","h","tryInline","cmpCall","cmp","genCode","cmpfun","doTryCatch","tryCatchOne","tryCatchList","tryCatch","compiler:::tryCmpfun","hessian","rhapson_newton","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","%*%","hessian","rhapson_newton","l = l - (y[i]*log(u[i]) + (1-y[i])*log(1-u[i]))","loglikl","rhapson_newton","%*%","hessian","rhapson_newton","grd= gradient(x_sub = x,y = y,beta = beta)","rhapson_newton","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))","loglikl","rhapson_newton","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","%*%","hessian","rhapson_newton","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton","dir = solve(hes) %*% grd","rhapson_newton","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","<GC>","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","%*%","hessian","rhapson_newton","%*%","hessian","rhapson_newton","h = h + u[i]*(1-u[i]) * txsub %*% x_sub","hessian","rhapson_newton","%*%","hessian","rhapson_newton","%*%","hessian","rhapson_newton","%*%","hessian","rhapson_newton","g = g + x_sub[i,]*(u[i]-y[i])","gradient","rhapson_newton","%*%","hessian","rhapson_newton"],"filenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,2,1,1,2,null,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2],"linenum":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,70,70,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,71,71,2,20,70,2,42,71,2,42,71,2,9,69,2,42,71,2,70,2,20,70,2,42,71,2,5,69,2,42,71,2,42,71,2,20,70,2,72,2,42,71,2,null,42,71,2,42,71,2,42,71,2,42,71,2,42,71,2,42,71,2,42,71,2,20,70,2,42,71,2],"memalloc":[38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.5904998779297,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,38.8435287475586,39.562873840332,39.562873840332,39.562873840332,40.1357192993164,40.1357192993164,40.1357192993164,40.9945068359375,40.9945068359375,40.9945068359375,41.566032409668,41.566032409668,41.566032409668,42.4062347412109,42.4062347412109,42.4062347412109,42.9761581420898,42.9761581420898,43.8393783569336,43.8393783569336,43.8393783569336,44.4136810302734,44.4136810302734,44.4136810302734,45.2744522094727,45.2744522094727,45.2744522094727,45.8514862060547,45.8514862060547,45.8514862060547,46.7105941772461,46.7105941772461,46.7105941772461,47.2695693969727,47.2695693969727,47.2695693969727,48.1240692138672,48.1240692138672,48.6732940673828,48.6732940673828,48.6732940673828,49.3029098510742,49.3029098510742,49.3029098510742,49.3029098510742,38.6083679199219,38.6083679199219,38.6083679199219,39.4807510375977,39.4807510375977,39.4807510375977,40.0637969970703,40.0637969970703,40.0637969970703,40.9503555297852,40.9503555297852,40.9503555297852,41.5369644165039,41.5369644165039,41.5369644165039,42.4243087768555,42.4243087768555,42.4243087768555,43.0125961303711,43.0125961303711,43.0125961303711,43.8972091674805,43.8972091674805,43.8972091674805],"meminc":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.253028869628906,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.719345092773438,0,0,0.572845458984375,0,0,0.858787536621094,0,0,0.571525573730469,0,0,0.840202331542969,0,0,0.569923400878906,0,0.86322021484375,0,0,0.574302673339844,0,0,0.860771179199219,0,0,0.577033996582031,0,0,0.859107971191406,0,0,0.558975219726562,0,0,0.854499816894531,0,0.549224853515625,0,0,0.629615783691406,0,0,0,-10.6945419311523,0,0,0.872383117675781,0,0,0.583045959472656,0,0,0.886558532714844,0,0,0.58660888671875,0,0,0.887344360351562,0,0,0.588287353515625,0,0,0.884613037109375,0,0],"filename":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"./aux_fcts.R","./aux_fcts.R","<expr>",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>",null,"./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>","./aux_fcts.R","./aux_fcts.R","<expr>"]},"interval":10,"files":[{"filename":"<expr>","content":"p= profvis({\n  beta_s =  rhapson_newton(x = data$x[,1:k],y = data$y,betaO = rep(1,k),eps = 1e-3)\n})\n","normpath":"<expr>"},{"filename":"./aux_fcts.R","content":"# Auxiliary functions\n\nloglikl <- function(x_sub,y,beta) {\n  \n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  \n  l=0\n  for (i in 1:nrow(x_sub)) {\n    l = l - (y[i]*log(u[i]) + (1-y[i])*log(1-u[i]))\n  }\n  return(l)\n}\n\n\ngradient = function(x_sub,y,beta) {\n  g= rep(0,ncol(x_sub))\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  \n  for (i in 1:nrow(x_sub)) {\n    g = g + x_sub[i,]*(u[i]-y[i])\n  }\n  return(g)\n}\n\nhessian_old = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  h = matrix(0,ncol(x_sub),ncol(x_sub))\n  \n  for (i in 1:nrow(x_sub)) {\n    h = h + u[i]*(1-u[i]) * t(x_sub) %*% x_sub\n  }\n  return(h)\n}\n\n\nhessian = function(x_sub,y,beta) {\n  u = exp(x_sub %*% beta) / (1 + exp(x_sub %*% beta))\n  h = matrix(0,ncol(x_sub),ncol(x_sub))\n  txsub = t(x_sub)\n  \n  for (i in 1:nrow(x_sub)) {\n    h = h + u[i]*(1-u[i]) * txsub %*% x_sub\n  }\n  return(h)\n}\n\nnorm_vec <- function(x) sqrt(sum(x^2))\n\n\nrhapson_newton_old <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian_old(x_sub = x,y = y,beta = beta)\n    dir = solve(hes) %*% grd\n    beta = beta - dir\n  }\n  return(beta)\n}\n\nrhapson_newton <- function(x,y,betaO,eps) {\n  beta = betaO\n  dir = rep(eps+1,length(beta))\n  \n  while(norm_vec(dir)>eps)  {\n    lglik = loglikl(x_sub = x,y = y,beta = beta)\n    grd= gradient(x_sub = x,y = y,beta = beta)\n    hes= hessian(x_sub = x,y = y,beta = beta)\n    dir = solve(hes) %*% grd\n    beta = beta - dir\n  }\n  return(beta)\n}\n","normpath":"/home/hugoboum/Documents/Parallel Computing/Project/aux_fcts.R"}],"prof_output":"/home/hugoboum/Documents/Parallel Computing/Project/.Rproj.user/99588069/profiles-cache/file343b7b094015.Rprof","highlight":{"output":["^output\\$"],"gc":["^<GC>$"],"stacktrace":["^\\.\\.stacktraceo(n|ff)\\.\\.$"]},"split":"h"}},"evals":[],"jsHooks":[]}</script>
</body>
</html>
